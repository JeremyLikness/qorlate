/**
 * Correlated promises for AngularJS
 * @version v0.0.1-dev-2015-01-14
 * @link 
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,b){"use strict";!function(a){function c(a){return b.isFunction(a)?a():a}function d(){}function e(){}b.extend(d.prototype,{id:1,getId:function(){var a=this.id;return this.id+=1,a}}),b.extend(e.prototype,{provider:new d,timeout:5e3,correlations:{},setDefaultTime:function(a){this.timeout=a},setProvider:function(a){this.provider=a},$get:["$q","$timeout",function(a,b){function d(d){var f,g,h=a.defer(),i=null;return f=d&&d.id?c(d.id):e.provider.getId(),g=c(d&&Object.prototype.hasOwnProperty.call(d,"timeout")?d.timeout:e.timeout),g&&g>=0&&(i=b(function(){h.rejected=!0,h.reject({message:"Qorlate request Timed out.",id:f})},g)),e.correlations[f]||(e.correlations[f]=[]),e.correlations[f].push({defer:h,timer:i,timeout:g}),{id:f,promise:h.promise}}var e=this;return Object.defineProperty(d,"defaultTimeout",{configurable:!1,enumerable:!0,get:function(){return c(e.timeout)}}),d.immediate=function(b,c){var d=a.defer();return c?d.reject(b):d.resolve(b),d.promise},d.correlate=function(a,c,d){for(var f,g=!1;e.correlations[a]&&e.correlations[a].length;)f=e.correlations[a].pop(),g=!0,f.timer&&b.cancel(f.timer),f.defer.rejected||(d?f.defer.reject(c):f.defer.resolve(c));return g&&delete e.correlations[a],g},d.reject=function(a,b){return this.correlate(a,b,!0)},d.resolve=function(a,b){return this.correlate(a,b,!1)},d}]}),a.provider("qorlate",e)}(b.module("jlikness.qorlate",[]))}(window,window.angular);